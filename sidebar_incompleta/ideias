Minhas ideias sobre a logica pra implementar isso estão nos comentários dos arquivos
